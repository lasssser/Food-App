{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":52,"index":105}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"../store/authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":50,"index":156}}],"key":"/4BDl/hqolvw7T4CXD8jWAtZK4M=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":157},"end":{"line":9,"column":35,"index":312}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.usePushNotifications = usePushNotifications;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _expoNotifications = require(_dependencyMap[3], \"expo-notifications\");\n  var Notifications = _interopNamespace(_expoNotifications);\n  var _storeAuthStore = require(_dependencyMap[4], \"../store/authStore\");\n  var _servicesNotifications = require(_dependencyMap[5], \"../services/notifications\");\n  function usePushNotifications() {\n    _s();\n    var _useAuthStore = (0, _storeAuthStore.useAuthStore)(),\n      user = _useAuthStore.user,\n      isAuthenticated = _useAuthStore.isAuthenticated;\n    var _useState = (0, _react.useState)({\n        expoPushToken: null,\n        notification: null,\n        loading: true,\n        error: null\n      }),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n    var notificationListener = (0, _react.useRef)(null);\n    var responseListener = (0, _react.useRef)(null);\n    (0, _react.useEffect)(() => {\n      // Only register if user is logged in\n      if (!user || !isAuthenticated) {\n        setState(prev => ({\n          ...prev,\n          loading: false\n        }));\n        return;\n      }\n      var setupNotifications = /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          try {\n            // Register for push notifications\n            var token = yield (0, _servicesNotifications.registerForPushNotificationsAsync)();\n            if (token) {\n              setState(prev => ({\n                ...prev,\n                expoPushToken: token\n              }));\n\n              // Register token with backend\n              yield (0, _servicesNotifications.registerPushToken)(token);\n            }\n            setState(prev => ({\n              ...prev,\n              loading: false\n            }));\n          } catch (error) {\n            console.error('Error setting up notifications:', error);\n            setState(prev => ({\n              ...prev,\n              error: error instanceof Error ? error.message : 'Unknown error',\n              loading: false\n            }));\n          }\n        });\n        return function setupNotifications() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      setupNotifications();\n\n      // Listen for incoming notifications when app is in foreground\n      notificationListener.current = Notifications.addNotificationReceivedListener(notification => {\n        console.log('Notification received:', notification);\n        setState(prev => ({\n          ...prev,\n          notification\n        }));\n      });\n\n      // Listen for notification responses (when user taps notification)\n      responseListener.current = Notifications.addNotificationResponseReceivedListener(response => {\n        (0, _servicesNotifications.handleNotificationResponse)(response);\n      });\n      return () => {\n        notificationListener.current?.remove();\n        responseListener.current?.remove();\n      };\n    }, [user, isAuthenticated]);\n\n    // Cleanup on logout\n    var cleanup = /*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator.default)(function* () {\n        try {\n          yield (0, _servicesNotifications.unregisterPushToken)();\n          setState({\n            expoPushToken: null,\n            notification: null,\n            loading: false,\n            error: null\n          });\n        } catch (error) {\n          console.error('Error cleaning up notifications:', error);\n        }\n      });\n      return function cleanup() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    return {\n      ...state,\n      cleanup\n    };\n  }\n  _s(usePushNotifications, \"dZ4yWeGuIjl/unq3KSdDBRrQ2ro=\", false, function () {\n    return [_storeAuthStore.useAuthStore];\n  });\n});","lineCount":142,"map":[[28,2,18,0,"exports"],[28,9,18,0],[28,10,18,0,"usePushNotifications"],[28,30,18,0],[28,33,18,0,"usePushNotifications"],[28,53,18,0],[29,2,102,1],[29,6,102,1,"_babelRuntimeHelpersAsyncToGenerator"],[29,42,102,1],[29,45,102,1,"require"],[29,52,102,1],[29,53,102,1,"_dependencyMap"],[29,67,102,1],[30,2,102,1],[30,6,102,1,"_asyncToGenerator"],[30,23,102,1],[30,26,102,1,"_interopDefault"],[30,41,102,1],[30,42,102,1,"_babelRuntimeHelpersAsyncToGenerator"],[30,78,102,1],[31,2,102,1],[31,6,102,1,"_babelRuntimeHelpersSlicedToArray"],[31,39,102,1],[31,42,102,1,"require"],[31,49,102,1],[31,50,102,1,"_dependencyMap"],[31,64,102,1],[32,2,102,1],[32,6,102,1,"_slicedToArray"],[32,20,102,1],[32,23,102,1,"_interopDefault"],[32,38,102,1],[32,39,102,1,"_babelRuntimeHelpersSlicedToArray"],[32,72,102,1],[33,2,1,0],[33,6,1,0,"_react"],[33,12,1,0],[33,15,1,0,"require"],[33,22,1,0],[33,23,1,0,"_dependencyMap"],[33,37,1,0],[34,2,2,0],[34,6,2,0,"_expoNotifications"],[34,24,2,0],[34,27,2,0,"require"],[34,34,2,0],[34,35,2,0,"_dependencyMap"],[34,49,2,0],[35,2,2,0],[35,6,2,0,"Notifications"],[35,19,2,0],[35,22,2,0,"_interopNamespace"],[35,39,2,0],[35,40,2,0,"_expoNotifications"],[35,58,2,0],[36,2,3,0],[36,6,3,0,"_storeAuthStore"],[36,21,3,0],[36,24,3,0,"require"],[36,31,3,0],[36,32,3,0,"_dependencyMap"],[36,46,3,0],[37,2,4,0],[37,6,4,0,"_servicesNotifications"],[37,28,4,0],[37,31,4,0,"require"],[37,38,4,0],[37,39,4,0,"_dependencyMap"],[37,53,4,0],[38,2,18,7],[38,11,18,16,"usePushNotifications"],[38,31,18,36,"usePushNotifications"],[38,32,18,36],[38,34,18,39],[39,4,18,39,"_s"],[39,6,18,39],[40,4,19,2],[40,8,19,2,"_useAuthStore"],[40,21,19,2],[40,24,19,36],[40,28,19,36,"useAuthStore"],[40,43,19,48],[40,44,19,48,"useAuthStore"],[40,56,19,48],[40,58,19,49],[40,59,19,50],[41,6,19,10,"user"],[41,10,19,14],[41,13,19,14,"_useAuthStore"],[41,26,19,14],[41,27,19,10,"user"],[41,31,19,14],[42,6,19,16,"isAuthenticated"],[42,21,19,31],[42,24,19,31,"_useAuthStore"],[42,37,19,31],[42,38,19,16,"isAuthenticated"],[42,53,19,31],[43,4,20,2],[43,8,20,2,"_useState"],[43,17,20,2],[43,20,20,28],[43,24,20,28,"useState"],[43,30,20,36],[43,31,20,36,"useState"],[43,39,20,36],[43,41,20,60],[44,8,21,4,"expoPushToken"],[44,21,21,17],[44,23,21,19],[44,27,21,23],[45,8,22,4,"notification"],[45,20,22,16],[45,22,22,18],[45,26,22,22],[46,8,23,4,"loading"],[46,15,23,11],[46,17,23,13],[46,21,23,17],[47,8,24,4,"error"],[47,13,24,9],[47,15,24,11],[48,6,25,2],[48,7,25,3],[48,8,25,4],[49,6,25,4,"_useState2"],[49,16,25,4],[49,23,25,4,"_slicedToArray"],[49,37,25,4],[49,38,25,4,"default"],[49,45,25,4],[49,47,25,4,"_useState"],[49,56,25,4],[50,6,20,9,"state"],[50,11,20,14],[50,14,20,14,"_useState2"],[50,24,20,14],[51,6,20,16,"setState"],[51,14,20,24],[51,17,20,24,"_useState2"],[51,27,20,24],[52,4,27,2],[52,8,27,8,"notificationListener"],[52,28,27,28],[52,31,27,31],[52,35,27,31,"useRef"],[52,41,27,37],[52,42,27,37,"useRef"],[52,48,27,37],[52,50,27,73],[52,54,27,77],[52,55,27,78],[53,4,28,2],[53,8,28,8,"responseListener"],[53,24,28,24],[53,27,28,27],[53,31,28,27,"useRef"],[53,37,28,33],[53,38,28,33,"useRef"],[53,44,28,33],[53,46,28,69],[53,50,28,73],[53,51,28,74],[54,4,30,2],[54,8,30,2,"useEffect"],[54,14,30,11],[54,15,30,11,"useEffect"],[54,24,30,11],[54,26,30,12],[54,32,30,18],[55,6,31,4],[56,6,32,4],[56,10,32,8],[56,11,32,9,"user"],[56,15,32,13],[56,19,32,17],[56,20,32,18,"isAuthenticated"],[56,35,32,33],[56,37,32,35],[57,8,33,6,"setState"],[57,16,33,14],[57,17,33,15,"prev"],[57,21,33,19],[57,26,33,24],[58,10,33,26],[58,13,33,29,"prev"],[58,17,33,33],[59,10,33,35,"loading"],[59,17,33,42],[59,19,33,44],[60,8,33,50],[60,9,33,51],[60,10,33,52],[60,11,33,53],[61,8,34,6],[62,6,35,4],[63,6,37,4],[63,10,37,10,"setupNotifications"],[63,28,37,28],[64,8,37,28],[64,12,37,28,"_ref"],[64,16,37,28],[64,23,37,28,"_asyncToGenerator"],[64,40,37,28],[64,41,37,28,"default"],[64,48,37,28],[64,50,37,31],[64,63,37,43],[65,10,38,6],[65,14,38,10],[66,12,39,8],[67,12,40,8],[67,16,40,14,"token"],[67,21,40,19],[67,30,40,28],[67,34,40,28,"registerForPushNotificationsAsync"],[67,56,40,61],[67,57,40,61,"registerForPushNotificationsAsync"],[67,90,40,61],[67,92,40,62],[67,93,40,63],[68,12,42,8],[68,16,42,12,"token"],[68,21,42,17],[68,23,42,19],[69,14,43,10,"setState"],[69,22,43,18],[69,23,43,19,"prev"],[69,27,43,23],[69,32,43,28],[70,16,43,30],[70,19,43,33,"prev"],[70,23,43,37],[71,16,43,39,"expoPushToken"],[71,29,43,52],[71,31,43,54,"token"],[72,14,43,60],[72,15,43,61],[72,16,43,62],[72,17,43,63],[74,14,45,10],[75,14,46,10],[75,20,46,16],[75,24,46,16,"registerPushToken"],[75,46,46,33],[75,47,46,33,"registerPushToken"],[75,64,46,33],[75,66,46,34,"token"],[75,71,46,39],[75,72,46,40],[76,12,47,8],[77,12,49,8,"setState"],[77,20,49,16],[77,21,49,17,"prev"],[77,25,49,21],[77,30,49,26],[78,14,49,28],[78,17,49,31,"prev"],[78,21,49,35],[79,14,49,37,"loading"],[79,21,49,44],[79,23,49,46],[80,12,49,52],[80,13,49,53],[80,14,49,54],[80,15,49,55],[81,10,50,6],[81,11,50,7],[81,12,50,8],[81,19,50,15,"error"],[81,24,50,20],[81,26,50,22],[82,12,51,8,"console"],[82,19,51,15],[82,20,51,16,"error"],[82,25,51,21],[82,26,51,22],[82,59,51,55],[82,61,51,57,"error"],[82,66,51,62],[82,67,51,63],[83,12,52,8,"setState"],[83,20,52,16],[83,21,52,17,"prev"],[83,25,52,21],[83,30,52,26],[84,14,53,10],[84,17,53,13,"prev"],[84,21,53,17],[85,14,54,10,"error"],[85,19,54,15],[85,21,54,17,"error"],[85,26,54,22],[85,38,54,34,"Error"],[85,43,54,39],[85,46,54,42,"error"],[85,51,54,47],[85,52,54,48,"message"],[85,59,54,55],[85,62,54,58],[85,77,54,73],[86,14,55,10,"loading"],[86,21,55,17],[86,23,55,19],[87,12,56,8],[87,13,56,9],[87,14,56,10],[87,15,56,11],[88,10,57,6],[89,8,58,4],[89,9,58,5],[90,8,58,5],[90,24,37,10,"setupNotifications"],[90,42,37,28,"setupNotifications"],[90,43,37,28],[91,10,37,28],[91,17,37,28,"_ref"],[91,21,37,28],[91,22,37,28,"apply"],[91,27,37,28],[91,34,37,28,"arguments"],[91,43,37,28],[92,8,37,28],[93,6,37,28],[93,9,58,5],[94,6,60,4,"setupNotifications"],[94,24,60,22],[94,25,60,23],[94,26,60,24],[96,6,62,4],[97,6,63,4,"notificationListener"],[97,26,63,24],[97,27,63,25,"current"],[97,34,63,32],[97,37,63,35,"Notifications"],[97,50,63,48],[97,51,63,49,"addNotificationReceivedListener"],[97,82,63,80],[97,83,64,7,"notification"],[97,95,64,19],[97,99,64,24],[98,8,65,8,"console"],[98,15,65,15],[98,16,65,16,"log"],[98,19,65,19],[98,20,65,20],[98,44,65,44],[98,46,65,46,"notification"],[98,58,65,58],[98,59,65,59],[99,8,66,8,"setState"],[99,16,66,16],[99,17,66,17,"prev"],[99,21,66,21],[99,26,66,26],[100,10,66,28],[100,13,66,31,"prev"],[100,17,66,35],[101,10,66,37,"notification"],[102,8,66,50],[102,9,66,51],[102,10,66,52],[102,11,66,53],[103,6,67,6],[103,7,68,4],[103,8,68,5],[105,6,70,4],[106,6,71,4,"responseListener"],[106,22,71,20],[106,23,71,21,"current"],[106,30,71,28],[106,33,71,31,"Notifications"],[106,46,71,44],[106,47,71,45,"addNotificationResponseReceivedListener"],[106,86,71,84],[106,87,72,7,"response"],[106,95,72,15],[106,99,72,20],[107,8,73,8],[107,12,73,8,"handleNotificationResponse"],[107,34,73,34],[107,35,73,34,"handleNotificationResponse"],[107,61,73,34],[107,63,73,35,"response"],[107,71,73,43],[107,72,73,44],[108,6,74,6],[108,7,75,4],[108,8,75,5],[109,6,77,4],[109,13,77,11],[109,19,77,17],[110,8,78,6,"notificationListener"],[110,28,78,26],[110,29,78,27,"current"],[110,36,78,34],[110,38,78,36,"remove"],[110,44,78,42],[110,45,78,43],[110,46,78,44],[111,8,79,6,"responseListener"],[111,24,79,22],[111,25,79,23,"current"],[111,32,79,30],[111,34,79,32,"remove"],[111,40,79,38],[111,41,79,39],[111,42,79,40],[112,6,80,4],[112,7,80,5],[113,4,81,2],[113,5,81,3],[113,7,81,5],[113,8,81,6,"user"],[113,12,81,10],[113,14,81,12,"isAuthenticated"],[113,29,81,27],[113,30,81,28],[113,31,81,29],[115,4,83,2],[116,4,84,2],[116,8,84,8,"cleanup"],[116,15,84,15],[117,6,84,15],[117,10,84,15,"_ref2"],[117,15,84,15],[117,22,84,15,"_asyncToGenerator"],[117,39,84,15],[117,40,84,15,"default"],[117,47,84,15],[117,49,84,18],[117,62,84,30],[118,8,85,4],[118,12,85,8],[119,10,86,6],[119,16,86,12],[119,20,86,12,"unregisterPushToken"],[119,42,86,31],[119,43,86,31,"unregisterPushToken"],[119,62,86,31],[119,64,86,32],[119,65,86,33],[120,10,87,6,"setState"],[120,18,87,14],[120,19,87,15],[121,12,88,8,"expoPushToken"],[121,25,88,21],[121,27,88,23],[121,31,88,27],[122,12,89,8,"notification"],[122,24,89,20],[122,26,89,22],[122,30,89,26],[123,12,90,8,"loading"],[123,19,90,15],[123,21,90,17],[123,26,90,22],[124,12,91,8,"error"],[124,17,91,13],[124,19,91,15],[125,10,92,6],[125,11,92,7],[125,12,92,8],[126,8,93,4],[126,9,93,5],[126,10,93,6],[126,17,93,13,"error"],[126,22,93,18],[126,24,93,20],[127,10,94,6,"console"],[127,17,94,13],[127,18,94,14,"error"],[127,23,94,19],[127,24,94,20],[127,58,94,54],[127,60,94,56,"error"],[127,65,94,61],[127,66,94,62],[128,8,95,4],[129,6,96,2],[129,7,96,3],[130,6,96,3],[130,22,84,8,"cleanup"],[130,29,84,15,"cleanup"],[130,30,84,15],[131,8,84,15],[131,15,84,15,"_ref2"],[131,20,84,15],[131,21,84,15,"apply"],[131,26,84,15],[131,33,84,15,"arguments"],[131,42,84,15],[132,6,84,15],[133,4,84,15],[133,7,96,3],[134,4,98,2],[134,11,98,9],[135,6,99,4],[135,9,99,7,"state"],[135,14,99,12],[136,6,100,4,"cleanup"],[137,4,101,2],[137,5,101,3],[138,2,102,0],[139,2,102,1,"_s"],[139,4,102,1],[139,5,18,16,"usePushNotifications"],[139,25,18,36],[140,4,18,36],[140,12,19,36,"useAuthStore"],[140,27,19,48],[140,28,19,48,"useAuthStore"],[140,40,19,48],[141,2,19,48],[142,0,19,48],[142,3]],"functionMap":{"names":["<global>","usePushNotifications","useEffect$argument_0","setState$argument_0","setupNotifications","Notifications.addNotificationReceivedListener$argument_0","Notifications.addNotificationResponseReceivedListener$argument_0","<anonymous>","cleanup"],"mappings":"AAA;OCiB;YCY;eCG,qCD;+BEI;mBDM,2CC;iBDM,qCC;iBDG;UCI;KFE;MGM;iBFE,mCE;OHC;MIK;OJE;WKG;KLG;GDC;kBOG;GPY;CDM"},"hasCjsExports":false},"type":"js/module"}]}